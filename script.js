      const translations = {
            en: {
                title: "NumGuess",
                mode3title: "3 numbers",
                mode3desc: "6 attempts",
                mode4title: "4 numbers",
                mode4desc: "10 attempts",
                mode5title: "5 numbers",
                mode5desc: "12 attempts",
                attempts: "Attempts",
                maxattempts: "Max",
                submit: "Submit",
                entercode: "Number",
                howtoplay: "How to Play",
                rule1: "Guess the secret code with unique digits.",
                rule2: "After each guess, the color shows how close you are:",
                correct: "Correct digit, correct position",
                present: "Correct digit, wrong position",
                absent: "Digit not in code",
                close: "Close",
                playagain: "Play Again",
                won: "Victory!",
                lost: "Game Over",
                wondesc: "You guessed the code!",
                lostdesc: "The code was:",
                duplicate: "All digits must be unique!"
            },
            ru: {
                title: "NumGuess",
                mode3title: "3 Ñ†Ð¸Ñ„Ñ€Ñ‹",
                mode3desc: "6 Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº",
                mode4title: "4 Ñ†Ð¸Ñ„Ñ€Ñ‹",
                mode4desc: "10 Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº",
                mode5title: "5 Ñ†Ð¸Ñ„Ñ€",
                mode5desc: "12 Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº",
                attempts: "ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ¸",
                maxattempts: "ÐœÐ°ÐºÑ",
                submit: "ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ",
                entercode: "ÐÐ¾Ð¼ÐµÑ€",
                howtoplay: "ÐšÐ°Ðº Ð¸Ð³Ñ€Ð°Ñ‚ÑŒ",
                rule1: "Ð£Ð³Ð°Ð´Ð°Ð¹Ñ‚Ðµ ÑÐµÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¹ ÐºÐ¾Ð´ Ñ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ñ†Ð¸Ñ„Ñ€Ð°Ð¼Ð¸.",
                rule2: "ÐŸÐ¾ÑÐ»Ðµ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ñ†Ð²ÐµÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð½Ð°ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²Ñ‹ Ð±Ð»Ð¸Ð·ÐºÐ¸:",
                correct: "ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ Ñ†Ð¸Ñ„Ñ€Ð°, Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ",
                present: "ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ Ñ†Ð¸Ñ„Ñ€Ð°, Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ",
                absent: "Ð¦Ð¸Ñ„Ñ€Ñ‹ Ð½ÐµÑ‚ Ð² ÐºÐ¾Ð´Ðµ",
                close: "Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",
                playagain: "Ð˜Ð³Ñ€Ð°Ñ‚ÑŒ ÑÐ½Ð¾Ð²Ð°",
                won: "ÐŸÐ¾Ð±ÐµÐ´Ð°!",
                lost: "Ð˜Ð³Ñ€Ð° Ð¾ÐºÐ¾Ð½Ñ‡ÐµÐ½Ð°",
                wondesc: "Ð’Ñ‹ ÑƒÐ³Ð°Ð´Ð°Ð»Ð¸ ÐºÐ¾Ð´!",
                lostdesc: "ÐšÐ¾Ð´ Ð±Ñ‹Ð»:",
                duplicate: "Ð’ÑÐµ Ñ†Ð¸Ñ„Ñ€Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸!"
            },
            ro: {
                title: "NumGuess",
                mode3title: "3 cifre",
                mode3desc: "6 Ã®ncercÄƒri",
                mode4title: "4 cifre",
                mode4desc: "10 Ã®ncercÄƒri",
                mode5title: "5 cifre",
                mode5desc: "12 Ã®ncercÄƒri",
                attempts: "ÃŽncercÄƒri",
                maxattempts: "Max",
                submit: "VerificÄƒ",
                entercode: "NumÄƒrul",
                howtoplay: "Cum se joacÄƒ",
                rule1: "GhiceÈ™te codul secret cu cifre unice.",
                rule2: "DupÄƒ fiecare Ã®ncercare, culoarea aratÄƒ cÃ¢t de aproape eÈ™ti:",
                correct: "CifrÄƒ corectÄƒ, poziÈ›ie corectÄƒ",
                present: "CifrÄƒ corectÄƒ, poziÈ›ie greÈ™itÄƒ",
                absent: "Cifra nu existÄƒ Ã®n cod",
                close: "ÃŽnchide",
                playagain: "JoacÄƒ din nou",
                won: "Victorie!",
                lost: "Joc terminat",
                wondesc: "Ai ghicit codul!",
                lostdesc: "Codul era:",
                duplicate: "Toate cifrele trebuie sÄƒ fie unice!"
            }
        };

        let currentLang = 'en';
        let secretCode = [];
        let maxAttempts = 6;
        let currentAttempts = 0;
        let gameMode = 0;
        let gameActive = false;

        function setLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.textContent = translations[lang][key];
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                el.placeholder = translations[lang][key];
            });
            document.querySelectorAll('.lang-option').forEach(opt => {
                opt.classList.remove('selected');
                if (opt.getAttribute('data-lang') === lang) {
                    opt.classList.add('selected');
                }
            });
        }

        function generateCode(length) {
            const digits = [0,1,2,3,4,5,6,7,8,9];
            const code = [];
            for (let i = 0; i < length; i++) {
                const idx = Math.floor(Math.random() * digits.length);
                code.push(digits[idx]);
                digits.splice(idx, 1);
            }
            return code;
        }

        function startGame(mode) {
            gameMode = parseInt(mode);
            maxAttempts = mode == 3 ? 6 : mode == 4 ? 10 : 12;
            secretCode = generateCode(gameMode);
            currentAttempts = 0;
            gameActive = true;

            document.getElementById('menuSelector').classList.remove('active');
            document.getElementById('gameArea').classList.add('active');
            document.getElementById('backBtn').classList.add('active');
            document.getElementById('codeInput').maxLength = gameMode;
            document.getElementById('attemptsValue').textContent = '0';
            document.getElementById('maxAttemptsValue').textContent = maxAttempts;
            document.getElementById('guessesContainer').innerHTML = '';
            document.getElementById('codeInput').value = '';
        }

        function checkGuess(guess) {
            const guessArr = guess.split('').map(Number);
            const feedback = [];

            guessArr.forEach((digit, idx) => {
                if (digit === secretCode[idx]) {
                    feedback.push('correct');
                } else if (secretCode.includes(digit)) {
                    feedback.push('present');
                } else {
                    feedback.push('absent');
                }
            });

            return feedback;
        }

        function displayGuess(guess, feedback) {
            const row = document.createElement('div');
            row.className = 'guess-row';

            guess.split('').forEach((digit, idx) => {
                const cell = document.createElement('div');
                cell.className = `guess-cell ${feedback[idx]}`;
                cell.textContent = digit;
                row.appendChild(cell);
            });

            document.getElementById('guessesContainer').appendChild(row);
        }

        function endGame(won) {
            gameActive = false;
            const modal = document.getElementById('resultModal');
            const icon = document.getElementById('resultIcon');
            const title = document.getElementById('resultTitle');
            const text = document.getElementById('resultText');

            if (won) {
                icon.textContent = 'ðŸŽ‰';
                title.textContent = translations[currentLang].won;
                text.textContent = translations[currentLang].wondesc;
            } else {
                icon.textContent = 'ðŸ˜”';
                title.textContent = translations[currentLang].lost;
                text.textContent = `${translations[currentLang].lostdesc} ${secretCode.join('')}`;
            }

            modal.classList.add('active');
        }

        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                startGame(btn.getAttribute('data-mode'));
            });
        });

        document.getElementById('submitBtn').addEventListener('click', () => {
            const input = document.getElementById('codeInput');
            const guess = input.value;

            if (!gameActive || guess.length !== gameMode) return;

            const digits = guess.split('');
            if (new Set(digits).size !== digits.length) {
                alert(translations[currentLang].duplicate);
                return;
            }

            const feedback = checkGuess(guess);
            displayGuess(guess, feedback);
            currentAttempts++;
            document.getElementById('attemptsValue').textContent = currentAttempts;

            if (feedback.every(f => f === 'correct')) {
                endGame(true);
            } else if (currentAttempts >= maxAttempts) {
                endGame(false);
            }

            input.value = '';
        });

        document.getElementById('codeInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('submitBtn').click();
            }
        });

        document.getElementById('codeInput').addEventListener('input', (e) => {
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });

        document.getElementById('helpBtn').addEventListener('click', () => {
            document.getElementById('helpModal').classList.add('active');
        });

        document.getElementById('closeHelp').addEventListener('click', () => {
            document.getElementById('helpModal').classList.remove('active');
        });

        document.getElementById('playAgain').addEventListener('click', () => {
            document.getElementById('resultModal').classList.remove('active');
            document.getElementById('gameArea').classList.remove('active');
            document.getElementById('backBtn').classList.remove('active');
            document.getElementById('menuSelector').classList.add('active');
        });

        document.getElementById('backBtn').addEventListener('click', () => {
            document.getElementById('gameArea').classList.remove('active');
            document.getElementById('backBtn').classList.remove('active');
            document.getElementById('menuSelector').classList.add('active');
            gameActive = false;
        });

        document.getElementById('langBtn').addEventListener('click', () => {
            document.getElementById('langMenu').classList.toggle('active');
        });

        document.querySelectorAll('.lang-option').forEach(opt => {
            opt.addEventListener('click', () => {
                setLanguage(opt.getAttribute('data-lang'));
                document.getElementById('langMenu').classList.remove('active');
            });
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.lang-dropdown')) {
                document.getElementById('langMenu').classList.remove('active');
            }
        });

        setLanguage('en');